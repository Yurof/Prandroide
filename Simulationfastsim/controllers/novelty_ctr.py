from controllers.novelty.fixed_structure_nn_numpy import SimpleNeuralControllerNumpy
from controllers.novelty.nsga2 import *

class NoveltyController:
	
	def __init__(self, env, test=True):
		
		self.env = env
		self.nn = SimpleNeuralControllerNumpy(*[12,2,2,10])
		if test:
		    indmin=[-0.5117541890404027, 5.618372179640957, 18.777731848134998, -2.43907955035802, 14.54949508192692, 11.350799149702425, -11.304815110927855, 14.379592291046954, -28.747108033250857, -25.322937323735843, 1.3684183070060882, -9.903440337358038, 5.550114924169733, 23.42683806246194, 27.778501148414726, 25.841048918573087, -24.19687963631369, -28.239488733236044, 10.048554258253525, 7.238499542188215, 13.315488001584995, -9.050957981428201, -22.621012734114437, -5.268017026516162, 19.20333566180659, -29.039229751620013, -3.031465584262669, 11.59091413201299, -6.8423872872070035, 23.15216696235524, -12.244136738457101, -24.327110170041774, 18.842892381642557, 25.364786171461624, 29.85856836935396, 2.348160760972597, -14.349917783347472, -15.30737943682388, -25.951036182593334, 12.539423581135566, 20.517130866505234, 3.692416705562131, -0.38758879040013383, -27.11914950915658, -20.464769135814564, 11.37623179738754, 3.487363092617798, -22.10913322156545, 20.11660208024699, -2.078100250231362, -29.785495864549677, 0.042748537156505506, -9.460281677507854, -15.262688529783965, 3.0841589960941675, -0.928093604306877, -5.139733982511789, -24.26359082678509, -13.337390029043618, -9.00758798116988, -21.949249547743968, 23.89873433752711, 24.300784288679203, 22.755333433156352, -1.1048999844257104, -19.84738533613202, -21.914401961555704, 18.64290369406148, 24.01556728253685, 22.154046812982067, -24.387402985850574, 25.516680216665492, 1.748707794553603, 18.144116791922144, -12.437615347181946, 11.579928306550059, 24.585797711313525, -18.547042242209464, 2.952294013147153, -21.654704910576697, 26.733611953692638, 19.726237551929806, 18.223861855267955, 21.124789127128814, 24.954563643673765, 8.937483398790242, 7.700897749997139, -12.196464862515942, -28.040388566144177, -7.838089379876351, -7.118054168692954, 13.546617027150468, 16.752159531896638, -9.725119462184526, -18.92231372721871, 27.75033642627261, 9.231711571897662, -2.225056363590557, 22.13517668059461, 29.68414662005872, -6.697660245635994, 23.9715909428905, 3.788526394811882, 18.665473711456855, -22.490566482431078, -22.394396764178182, 2.592202115414004, -9.4713305709436, -23.9077875084452, -7.991155372851026, -23.948829731549555, 20.32081263651787, -17.573283465803634, -19.652159167447856, -15.701687711978707, -19.64157905255524, -18.783134332057255, 18.671491882063734, 2.7591755513648337, -17.331157668054235, -19.03040260191977, -23.42970877197069, -16.28711642500469, 10.65802419405852, 0.4194576090384743, 4.748746481748668, -22.91800197029187, -7.006294999114324, -15.480399198918276, -23.64323815963583, -6.634034340858925, -0.8995103105038567, 18.4414834199124, 19.632632281632524, -15.02747334359848, -16.30967251173822, -3.505270852554297, -2.7090461043603327, 28.012148169492527, 22.92842739698895, -20.62706456158805, -1.3899329097640667, -14.828074376527969, 10.365843471265158, 1.9827510310312064, -18.019477504077233, 26.51775452171063, -7.872398967260075, 2.6125896324694935, 29.87481510155365, 28.69709421816333, 0.9313429100328747, -0.25378277570313656, 8.210107236687051, 27.833267713619477, 22.622441100009276, -28.761602832340188, 11.746936960532686, -28.672455234889963, -15.954078227434605, -12.171698084771123, 9.477090812193914, 9.708069981752516, 16.756578171395617, -9.533232947619922, 29.843393861899756, 26.01597518988074, 13.188276649800855, 11.12312566519551, -14.588516418726993, 21.505768950693913, 7.617412222586175, 27.904084570077806, -24.388625248719755, 5.081086398883649, -10.523893406890522, -14.991612621996513, 13.3445328917025, -7.55166056436056, -4.513162048789969, -6.648462030324268, 18.54439105350253, 16.641678256241136, 2.530963484104433, 7.650125634668356, 4.9690487646201476, 27.204163078751186, 13.262535299219365, 24.614544448198444, 13.089806691201403, -5.547151248557402, -13.701559987986325, -0.8291715854511814, 17.850508703095123, -1.3429815926691404, 22.045288415261815, -22.356239608225238, 24.95465630992446, 10.669506253915507, -9.991703919896004, -21.452041221850862, 5.568153100007244, 4.488020975180142, 5.173856475787339, -5.660536841344655, 13.368111456979292, 6.418122717147114, 28.134129923415358, -20.064898286524205, 14.07516084551812, 29.8743605558697, -5.8993478510369926, 8.035230771153131, 13.441531374931763, -24.118972693774943, 28.209172324508245, 17.336860490827974, -20.486047182170573, 3.7603380926681353, 8.691537286947913, -14.610372813733788, -28.8503711520871, 5.728238136263123, 27.536341371711174, 3.8446355144059225, -17.834446013652112, 29.33965549620425, 18.116772789167364, -5.511897600069112, 10.612558074777233, 16.62787048623013, -23.792973899138506, 16.968235282918094, -19.751807290080674, 7.470069291347812, -4.868245465236718, 5.068699811303418, 20.965138961376944, 5.290867867451794, -24.954372327838485, -18.86611943422529, -19.236772945847687, 4.631635168089872, 15.546305719020232, -4.147947145922373, -2.127535113840864, -19.35094921437495, 0.9024978367604888, -29.439478427657974, -16.719813814185073, -22.494059533196236, 20.074954550865932, -22.519490740747617, -24.074054674044465, -2.4541027646179856, 26.767102030763546, 13.558073338164029, 1.2576958420813114, -24.783642796700523, 25.35402480215307, 0.08451177133109056, 12.709815676759085]
		else:
		    _, _, indmin = launch_nsga2(environment=self.env)
		    with open("controllers/novelty/paretofront_save.txt", "a") as f:
		        f.write(str(indmin) + '\n')
		        
		self.nn.set_parameters(indmin)
		    
	def get_command(self):
		
		sensors = self.env.get_all_sensors()
		action = self.nn.predict(sensors)
		return action
	
	def reset(self):
		pass
